<!DOCTYPE html>
<html lang='ar' dir='rtl'>
<head>
    <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุชุญูู - ูุณูู ูุงูู ุจุฑู</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- ุชุญููู Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
</head>
<body>
    <h2>ููุญุฉ ุชุญูู - ูุณูู ูุงูู ุจุฑู</h2>

    <div class="container">
        <!-- ูุณู ุชุณุฌูู ุงูุฏุฎูู -->
        <div id="login-section" class="form-container">
            <h3>ุชุณุฌูู ุงูุฏุฎูู ููุฅุฏุงุฑุฉ</h3>
            <form id="login-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="email">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                        <input type="email" id="email" required value="www735981122@gmail.com">
                    </div>
                    <div class="form-group">
                        <label for="password">ูููุฉ ุงููุฑูุฑ</label>
                        <input type="password" id="password" required placeholder="ุฃุฏุฎู ูููุฉ ุงููุฑูุฑ ุงูุชู ุนููุชูุง ูู Firebase">
                    </div>
                </div>
                <div class="form-row">
                    <button type="submit" class="btn btn-primary">ุชุณุฌูู ุงูุฏุฎูู</button>
                </div>
                <div id="login-message"></div>
                <div class="form-row">
                    <small>ุชุฃูุฏ ูู ุชูุนูู ุฎุฏูุฉ ุงููุตุงุฏูุฉ ูู Firebase Console</small>
                </div>
            </form>
        </div>

        <!-- ูุณู ููุญุฉ ุงูุชุญูู -->
        <div id="dashboard-section" class="hidden">
            <div class="form-container">
                <h3 id="form-title">ุฅุถุงูุฉ ูุจุงุฑุงุฉ ุฌุฏูุฏุฉ</h3>
                <form id="match-form">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="league">ุงูุฏูุฑู *</label>
                            <input type="text" id="league" required placeholder="ูุซุงู: ุงูุฏูุฑู ุงูุงูุฌููุฒู ุงูููุชุงุฒ">
                        </div>
                        <div class="form-group">
                            <label for="league-logo">ุฑุงุจุท ุดุนุงุฑ ุงูุฏูุฑู</label>
                            <input type="text" id="league-logo" placeholder="https://example.com/logo.png">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="team1">ุงููุฑูู ุงูุฃูู *</label>
                            <input type="text" id="team1" required placeholder="ูุซุงู: ููุชููุบูุงู">
                        </div>
                        <div class="form-group">
                            <label for="team1-logo">ุฑุงุจุท ุดุนุงุฑ ุงููุฑูู ุงูุฃูู</label>
                            <input type="text" id="team1-logo" placeholder="https://example.com/team1.png">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="team2">ุงููุฑูู ุงูุซุงูู *</label>
                            <input type="text" id="team2" required placeholder="ูุซุงู: ุจุฑููุชููุฑุฏ">
                        </div>
                        <div class="form-group">
                            <label for="team2-logo">ุฑุงุจุท ุดุนุงุฑ ุงููุฑูู ุงูุซุงูู</label>
                            <input type="text" id="team2-logo" placeholder="https://example.com/team2.png">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="match-time">ููุช ุงููุจุงุฑุงุฉ *</label>
                            <input type="text" id="match-time" required placeholder="ูุซุงู: 04:00ู">
                        </div>
                        <div class="form-group">
                            <label for="channel">ุงูููุงุฉ ุงููุงููุฉ *</label>
                            <input type="text" id="channel" required placeholder="ูุซุงู: bein sport 2">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="commentator">ุงุณู ุงููุนูู *</label>
                            <input type="text" id="commentator" required placeholder="ูุซุงู: ุฃุญูุฏ ุงูุจููุดู">
                        </div>
                        <div class="form-group">
                            <label for="match-date">ุงูุชุงุฑูุฎ *</label>
                            <input type="text" id="match-date" required placeholder="ูุซุงู: ุงูุฃุญุฏ 17 ุฃุบุณุทุณ 2025">
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="links">ุฑูุงุจุท ุงููุดุงูุฏุฉ * (ูู ุฑุงุจุท ูู ุณุทุฑ ุฌุฏูุฏ)</label>
                            <textarea id="links" required placeholder="https://example.com/stream1
https://example.com/stream2
https://example.com/stream3"></textarea>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <button type="submit" class="btn btn-primary" id="submit-btn">ุฅุถุงูุฉ ุงููุจุงุฑุงุฉ</button>
                        <button type="button" class="btn btn-danger hidden" id="cancel-btn">ุฅูุบุงุก ุงูุชุนุฏูู</button>
                        <button type="button" class="btn btn-secondary" id="logout-btn">ุชุณุฌูู ุงูุฎุฑูุฌ</button>
                        <a href="index.html" class="btn btn-success">ุนุฑุถ ุงููููุน</a>
                    </div>
                    <div id="form-message"></div>
                </form>
            </div>

            <div class="matches-container">
                <h3>ุงููุจุงุฑูุงุช ุงููุถุงูุฉ</h3>
                <div id="matches-list">
                    <div class="loading">ุฌุงุฑู ุชุญููู ุงููุจุงุฑูุงุช...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ุฅุนุฏุงุฏุงุช Firebase
        const firebaseConfig = {
            apiKey: "AIzaSyCqE7ZwveHg1dIhYf1Hlo7OpHyCZudeZvM",
            authDomain: "wacel-live.firebaseapp.com",
            databaseURL: "https://wacel-live-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "wacel-live",
            storageBucket: "wacel-live.firebasestorage.app",
            messagingSenderId: "185108554006",
            appId: "1:185108554006:web:93171895b1d4bb07c6f037"
        };

        // ุชููุฆุฉ Firebase
        try {
            firebase.initializeApp(firebaseConfig);
            const auth = firebase.auth();
            const database = firebase.database();
            
            console.log("โ ุชู ุชููุฆุฉ Firebase ุจูุฌุงุญ");
            
            // ุฌุนููุง ูุชุงุญุฉ ุนุงูููุงู
            window.firebaseAuth = auth;
            window.firebaseDb = database;
            
        } catch (error) {
            console.error("โ ุฎุทุฃ ูู ุชููุฆุฉ Firebase:", error);
        }

        // ุงูุงูุชุธุงุฑ ุญุชู ุชุญููู ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', function() {
            console.log("๐ ุชู ุชุญููู ุงูุตูุญุฉ");
            
            // ุนูุงุตุฑ DOM
            const loginSection = document.getElementById('login-section');
            const dashboardSection = document.getElementById('dashboard-section');
            const loginForm = document.getElementById('login-form');
            const logoutBtn = document.getElementById('logout-btn');
            const loginMessage = document.getElementById('login-message');
            
            const matchForm = document.getElementById('match-form');
            const formTitle = document.getElementById('form-title');
            const submitBtn = document.getElementById('submit-btn');
            const cancelBtn = document.getElementById('cancel-btn');
            const formMessage = document.getElementById('form-message');
            const matchesList = document.getElementById('matches-list');
            
            let currentEditId = null;
            
            // ุงูุชุญูู ูู ุญุงูุฉ ุงููุตุงุฏูุฉ
            if (window.firebaseAuth) {
                window.firebaseAuth.onAuthStateChanged(function(user) {
                    console.log("๐ค ุญุงูุฉ ุงููุตุงุฏูุฉ:", user ? "ูุณุฌู ุฏุฎูู" : "ุบูุฑ ูุณุฌู");
                    if (user) {
                        loginSection.classList.add('hidden');
                        dashboardSection.classList.remove('hidden');
                        showMessage(loginMessage, "โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ!", "success");
                        loadMatches();
                    } else {
                        loginSection.classList.remove('hidden');
                        dashboardSection.classList.add('hidden');
                    }
                });
            } else {
                console.error("โ firebaseAuth ุบูุฑ ูุชููุฑ");
                showMessage(loginMessage, "โ ุฎุฏูุฉ ุงููุตุงุฏูุฉ ุบูุฑ ูุชููุฑุฉ. ุชุฃูุฏ ูู ุฅุนุฏุงุฏุงุช Firebase.", "error");
            }
            
            // ุชุณุฌูู ุงูุฏุฎูู
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                console.log("๐ ูุนุงูุฌุฉ ุชุณุฌูู ุงูุฏุฎูู...");
                
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const loginBtn = loginForm.querySelector('button[type="submit"]');
                
                // ุชุนุทูู ุงูุฒุฑ ุฃุซูุงุก ุงููุนุงูุฌุฉ
                loginBtn.disabled = true;
                loginBtn.textContent = "ุฌุงุฑู ุชุณุฌูู ุงูุฏุฎูู...";
                
                if (!window.firebaseAuth) {
                    showMessage(loginMessage, "โ ุฎุฏูุฉ ุงููุตุงุฏูุฉ ุบูุฑ ูุชุงุญุฉ. ุญุงูู ุชุญุฏูุซ ุงูุตูุญุฉ.", "error");
                    loginBtn.disabled = false;
                    loginBtn.textContent = "ุชุณุฌูู ุงูุฏุฎูู";
                    return;
                }
                
                // ูุญุงููุฉ ุชุณุฌูู ุงูุฏุฎูู
                window.firebaseAuth.signInWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        console.log("โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ:", userCredential.user.email);
                        showMessage(loginMessage, "โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ!", "success");
                    })
                    .catch((error) => {
                        console.error("โ ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู:", error);
                        let errorMessage = "โ ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู";
                        
                        if (error.code === 'auth/invalid-credential') {
                            errorMessage = "โ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
                        } else if (error.code === 'auth/user-not-found') {
                            errorMessage = "โ ูู ูุชู ุงูุนุซูุฑ ุนูู ูุณุชุฎุฏู ุจูุฐุง ุงูุจุฑูุฏ ุงูุฅููุชุฑููู";
                        } else if (error.code === 'auth/wrong-password') {
                            errorMessage = "โ ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
                        } else if (error.code === 'auth/network-request-failed') {
                            errorMessage = "โ ูุดููุฉ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช";
                        } else if (error.code === 'auth/too-many-requests') {
                            errorMessage = "โ ูุญุงููุงุช ุชุณุฌูู ุฏุฎูู ูุซูุฑุฉ. ุญุงูู ูุงุญูุงู";
                        } else {
                            errorMessage = "โ " + error.message;
                        }
                        
                        showMessage(loginMessage, errorMessage, "error");
                    })
                    .finally(() => {
                        // ุฅุนุงุฏุฉ ุชูููู ุงูุฒุฑ
                        loginBtn.disabled = false;
                        loginBtn.textContent = "ุชุณุฌูู ุงูุฏุฎูู";
                    });
            });
            
            // ุชุณุฌูู ุงูุฎุฑูุฌ
            logoutBtn.addEventListener('click', function() {
                if (window.firebaseAuth) {
                    window.firebaseAuth.signOut()
                        .then(() => {
                            showMessage(loginMessage, "โ ุชู ุชุณุฌูู ุงูุฎุฑูุฌ ุจูุฌุงุญ", "success");
                        })
                        .catch((error) => {
                            console.error('โ ุฎุทุฃ ูู ุชุณุฌูู ุงูุฎุฑูุฌ:', error);
                        });
                }
            });
            
            // ุฅุฑุณุงู ูููุฐุฌ ุงููุจุงุฑุงุฉ
            matchForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (!window.firebaseAuth || !window.firebaseAuth.currentUser) {
                    showMessage(formMessage, "โ ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู ุฃููุงู", "error");
                    return;
                }
                
                // ุฌูุน ุงูุจูุงูุงุช ูู ุงููููุฐุฌ
                const matchData = {
                    league: document.getElementById('league').value,
                    leagueLogo: document.getElementById('league-logo').value,
                    team1: document.getElementById('team1').value,
                    team1Logo: document.getElementById('team1-logo').value,
                    team2: document.getElementById('team2').value,
                    team2Logo: document.getElementById('team2-logo').value,
                    time: document.getElementById('match-time').value,
                    channel: document.getElementById('channel').value,
                    commentator: document.getElementById('commentator').value,
                    date: document.getElementById('match-date').value,
                    links: document.getElementById('links').value.split('\n').filter(link => link.trim() !== ''),
                    createdAt: Date.now()
                };
                
                // ุชุนุทูู ุงูุฒุฑ ุฃุซูุงุก ุงููุนุงูุฌุฉ
                submitBtn.disabled = true;
                submitBtn.textContent = "ุฌุงุฑู ุงูุญูุธ...";
                
                if (currentEditId) {
                    // ุชุญุฏูุซ ูุจุงุฑุงุฉ ููุฌูุฏุฉ
                    window.firebaseDb.ref('matches/' + currentEditId).update(matchData)
                        .then(() => {
                            showMessage(formMessage, "โ ุชู ุชุญุฏูุซ ุงููุจุงุฑุงุฉ ุจูุฌุงุญ!", "success");
                            resetForm();
                        })
                        .catch(error => {
                            showMessage(formMessage, "โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญุฏูุซ ุงููุจุงุฑุงุฉ: " + error.message, "error");
                        })
                        .finally(() => {
                            submitBtn.disabled = false;
                            submitBtn.textContent = "ุชุญุฏูุซ ุงููุจุงุฑุงุฉ";
                        });
                } else {
                    // ุฅุถุงูุฉ ูุจุงุฑุงุฉ ุฌุฏูุฏุฉ
                    window.firebaseDb.ref('matches').push(matchData)
                        .then(() => {
                            showMessage(formMessage, "โ ุชู ุฅุถุงูุฉ ุงููุจุงุฑุงุฉ ุจูุฌุงุญ!", "success");
                            resetForm();
                        })
                        .catch(error => {
                            showMessage(formMessage, "โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุฅุถุงูุฉ ุงููุจุงุฑุงุฉ: " + error.message, "error");
                        })
                        .finally(() => {
                            submitBtn.disabled = false;
                            submitBtn.textContent = "ุฅุถุงูุฉ ุงููุจุงุฑุงุฉ";
                        });
                }
            });
            
            // ุฅูุบุงุก ุงูุชุนุฏูู
            cancelBtn.addEventListener('click', resetForm);
            
            // ุชุญููู ุงููุจุงุฑูุงุช ููุนุฑุถ ูู ููุญุฉ ุงูุชุญูู
            function loadMatches() {
                if (!window.firebaseDb) {
                    console.error("โ firebaseDb ุบูุฑ ูุชููุฑ");
                    return;
                }
                
                window.firebaseDb.ref('matches').on('value', function(snapshot) {
                    matchesList.innerHTML = '';
                    
                    if (!snapshot.exists()) {
                        matchesList.innerHTML = '<div class="loading">ูุง ุชูุฌุฏ ูุจุงุฑูุงุช ูุถุงูุฉ</div>';
                        return;
                    }
                    
                    snapshot.forEach(function(childSnapshot) {
                        const matchId = childSnapshot.key;
                        const match = childSnapshot.val();
                        
                        const matchItem = document.createElement('div');
                        matchItem.className = 'match-item';
                        matchItem.innerHTML = `
                            <div class="match-header">
                                <h4>${match.league}</h4>
                                <div class="actions">
                                    <button class="btn btn-primary" onclick="editMatch('${matchId}')">ุชุนุฏูู</button>
                                    <button class="btn btn-danger" onclick="deleteMatch('${matchId}')">ุญุฐู</button>
                                </div>
                            </div>
                            <div class="match-teams">
                                <div class="match-team">
                                    <img src="${match.team1Logo || 'https://via.placeholder.com/50?text=T1'}" alt="${match.team1}">
                                    <span>${match.team1}</span>
                                </div>
                                <div class="match-time">${match.time}</div>
                                <div class="match-team">
                                    <img src="${match.team2Logo || 'https://via.placeholder.com/50?text=T2'}" alt="${match.team2}">
                                    <span>${match.team2}</span>
                                </div>
                            </div>
                            <div class="match-details">
                                <div>${match.channel}</div>
                                <div>${match.commentator}</div>
                            </div>
                            <div class="links-container">
                                <strong>ุฑูุงุจุท ุงููุดุงูุฏุฉ (${match.links ? match.links.length : 0}):</strong>
                                ${match.links ? match.links.map((link, index) => 
                                    `<div class="link-item">${index + 1}. ${link}</div>`
                                ).join('') : '<div class="link-item">ูุง ุชูุฌุฏ ุฑูุงุจุท</div>'}
                            </div>
                        `;
                        
                        matchesList.appendChild(matchItem);
                    });
                }, function(error) {
                    matchesList.innerHTML = '<div class="error">โ ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงููุจุงุฑูุงุช</div>';
                    console.error("โ ุฎุทุฃ ูู ุชุญููู ุงููุจุงุฑูุงุช:", error);
                });
            }
            
            // ุชุนุฑูู ุงูุฏูุงู ุงูุนุงูููุฉ
            window.editMatch = function(matchId) {
                if (!window.firebaseDb) {
                    showMessage(formMessage, "โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุบูุฑ ูุชุงุญุฉ", "error");
                    return;
                }
                
                window.firebaseDb.ref('matches/' + matchId).once('value')
                    .then(function(snapshot) {
                        const match = snapshot.val();
                        
                        // ุชุนุจุฆุฉ ุงููููุฐุฌ ุจุจูุงูุงุช ุงููุจุงุฑุงุฉ
                        document.getElementById('league').value = match.league || '';
                        document.getElementById('league-logo').value = match.leagueLogo || '';
                        document.getElementById('team1').value = match.team1 || '';
                        document.getElementById('team1-logo').value = match.team1Logo || '';
                        document.getElementById('team2').value = match.team2 || '';
                        document.getElementById('team2-logo').value = match.team2Logo || '';
                        document.getElementById('match-time').value = match.time || '';
                        document.getElementById('channel').value = match.channel || '';
                        document.getElementById('commentator').value = match.commentator || '';
                        document.getElementById('match-date').value = match.date || '';
                        document.getElementById('links').value = match.links ? match.links.join('\n') : '';
                        
                        // ุชุบููุฑ ุญุงูุฉ ุงููููุฐุฌ ุฅูู ูุถุน ุงูุชุนุฏูู
                        formTitle.textContent = 'ุชุนุฏูู ุงููุจุงุฑุงุฉ';
                        submitBtn.textContent = 'ุชุญุฏูุซ ุงููุจุงุฑุงุฉ';
                        cancelBtn.classList.remove('hidden');
                        currentEditId = matchId;
                        
                        // ุงูุชูุฑูุฑ ุฅูู ุฃุนูู ุงููููุฐุฌ
                        matchForm.scrollIntoView({ behavior: 'smooth' });
                    })
                    .catch(error => {
                        showMessage(formMessage, "โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุชุญููู ุจูุงูุงุช ุงููุจุงุฑุงุฉ: " + error.message, "error");
                    });
            };
            
            window.deleteMatch = function(matchId) {
                if (confirm('โ๏ธ ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐู ุงููุจุงุฑุงุฉุ')) {
                    if (!window.firebaseDb) {
                        showMessage(formMessage, "โ ูุงุนุฏุฉ ุงูุจูุงูุงุช ุบูุฑ ูุชุงุญุฉ", "error");
                        return;
                    }
                    
                    window.firebaseDb.ref('matches/' + matchId).remove()
                        .then(() => {
                            showMessage(formMessage, "โ ุชู ุญุฐู ุงููุจุงุฑุงุฉ ุจูุฌุงุญ!", "success");
                        })
                        .catch(error => {
                            showMessage(formMessage, "โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุญุฐู ุงููุจุงุฑุงุฉ: " + error.message, "error");
                        });
                }
            };
            
            // ุฅุนุงุฏุฉ ุชุนููู ุงููููุฐุฌ
            function resetForm() {
                matchForm.reset();
                formTitle.textContent = 'ุฅุถุงูุฉ ูุจุงุฑุงุฉ ุฌุฏูุฏุฉ';
                submitBtn.textContent = 'ุฅุถุงูุฉ ุงููุจุงุฑุงุฉ';
                cancelBtn.classList.add('hidden');
                currentEditId = null;
                formMessage.innerHTML = '';
            }
            
            // ุนุฑุถ ุงูุฑุณุงุฆู
            function showMessage(element, message, type) {
                element.innerHTML = `<div class="${type}">${message}</div>`;
                setTimeout(() => {
                    element.innerHTML = '';
                }, 5000);
            }
        });
    </script>
</body>
</html>
