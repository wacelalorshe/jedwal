<!DOCTYPE html>
<html lang='ar' dir='rtl'>
<head>
    <meta charset='UTF-8'>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููุญุฉ ุงูุชุญูู - ูุณูู ูุงูู ุจุฑู</title>
    <link rel="stylesheet" href="styles.css">
    
    <!-- ุชุญููู Firebase SDK ูุจุงุดุฑุฉ -->
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.1/firebase-auth-compat.js"></script>
</head>
<body>
    <h2>ููุญุฉ ุชุญูู - ูุณูู ูุงูู ุจุฑู</h2>

    <div class="container">
        <!-- ูุณู ุชุณุฌูู ุงูุฏุฎูู -->
        <div id="login-section" class="form-container">
            <h3>ุชุณุฌูู ุงูุฏุฎูู ููุฅุฏุงุฑุฉ</h3>
            <form id="login-form">
                <div class="form-row">
                    <div class="form-group">
                        <label for="email">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                        <input type="email" id="email" required value="www735981122@gmail.com">
                    </div>
                    <div class="form-group">
                        <label for="password">ูููุฉ ุงููุฑูุฑ</label>
                        <input type="password" id="password" required>
                    </div>
                </div>
                <div class="form-row">
                    <button type="submit" class="btn btn-primary">ุชุณุฌูู ุงูุฏุฎูู</button>
                </div>
                <div id="login-message"></div>
                <div class="form-row">
                    <small>ููุชุฌุฑุจุฉ: ูููู ุงุณุชุฎุฏุงู ุฃู ุจุฑูุฏ ุฅููุชุฑููู ููููุฉ ูุฑูุฑ</small>
                </div>
            </form>
        </div>

        <!-- ูุณู ููุญุฉ ุงูุชุญูู -->
        <div id="dashboard-section" class="hidden">
            <!-- ... ููุณ ูุญุชูู ููุญุฉ ุงูุชุญูู ุงูุณุงุจู ... -->
        </div>
    </div>

    <!-- ุชุญููู ุฅุนุฏุงุฏุงุช Firebase -->
    <script src="firebase-config.js"></script>
    
    <script>
        // ุงูุงูุชุธุงุฑ ุญุชู ุชุญููู ุงูุตูุญุฉ
        document.addEventListener('DOMContentLoaded', function() {
            console.log("๐ ุชู ุชุญููู ุงูุตูุญุฉ");
            
            // ุนูุงุตุฑ DOM
            const loginSection = document.getElementById('login-section');
            const dashboardSection = document.getElementById('dashboard-section');
            const loginForm = document.getElementById('login-form');
            const loginMessage = document.getElementById('login-message');
            
            // ุงูุชุญูู ูู ุญุงูุฉ ุงููุตุงุฏูุฉ
            function checkAuthState() {
                if (window.firebaseAuth && window.firebaseAuth.onAuthStateChanged) {
                    window.firebaseAuth.onAuthStateChanged(function(user) {
                        console.log("๐ค ุญุงูุฉ ุงููุตุงุฏูุฉ:", user ? "ูุณุฌู ุฏุฎูู" : "ุบูุฑ ูุณุฌู");
                        if (user) {
                            loginSection.classList.add('hidden');
                            dashboardSection.classList.remove('hidden');
                            showMessage(loginMessage, "โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ!", "success");
                            loadMatches();
                        } else {
                            loginSection.classList.remove('hidden');
                            dashboardSection.classList.add('hidden');
                        }
                    });
                } else {
                    console.warn("โ๏ธ ุฎุฏูุฉ ุงููุตุงุฏูุฉ ุบูุฑ ูุชุงุญุฉ");
                    // ุฅุธูุงุฑ ูุงุฌูุฉ ุชุณุฌูู ุงูุฏุฎูู ูู ุญุงูุฉ ุนุฏู ุชููุฑ ุงููุตุงุฏูุฉ
                    loginSection.classList.remove('hidden');
                    dashboardSection.classList.add('hidden');
                }
            }
            
            // ุชุณุฌูู ุงูุฏุฎูู
            loginForm.addEventListener('submit', function(e) {
                e.preventDefault();
                console.log("๐ ูุนุงูุฌุฉ ุชุณุฌูู ุงูุฏุฎูู...");
                
                const email = document.getElementById('email').value;
                const password = document.getElementById('password').value;
                const loginBtn = loginForm.querySelector('button[type="submit"]');
                
                // ุชุนุทูู ุงูุฒุฑ ุฃุซูุงุก ุงููุนุงูุฌุฉ
                loginBtn.disabled = true;
                loginBtn.textContent = "ุฌุงุฑู ุชุณุฌูู ุงูุฏุฎูู...";
                
                // ุงูุชุญูู ูู ุชููุฑ ุฎุฏูุฉ ุงููุตุงุฏูุฉ
                if (!window.firebaseAuth || !window.firebaseAuth.signInWithEmailAndPassword) {
                    console.error("โ ุฎุฏูุฉ ุงููุตุงุฏูุฉ ุบูุฑ ูุชุงุญุฉ");
                    showMessage(loginMessage, "โ ุฎุฏูุฉ ุงููุตุงุฏูุฉ ุบูุฑ ูุชุงุญุฉ ุญุงููุงู", "error");
                    loginBtn.disabled = false;
                    loginBtn.textContent = "ุชุณุฌูู ุงูุฏุฎูู";
                    return;
                }
                
                // ูุญุงููุฉ ุชุณุฌูู ุงูุฏุฎูู
                window.firebaseAuth.signInWithEmailAndPassword(email, password)
                    .then((userCredential) => {
                        console.log("โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ:", userCredential.user.email);
                        showMessage(loginMessage, "โ ุชู ุชุณุฌูู ุงูุฏุฎูู ุจูุฌุงุญ!", "success");
                    })
                    .catch((error) => {
                        console.error("โ ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู:", error);
                        let errorMessage = "โ ุฎุทุฃ ูู ุชุณุฌูู ุงูุฏุฎูู";
                        
                        if (error.code === 'auth/invalid-credential') {
                            errorMessage = "โ ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ุฃู ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
                        } else if (error.code === 'auth/user-not-found') {
                            errorMessage = "โ ูู ูุชู ุงูุนุซูุฑ ุนูู ูุณุชุฎุฏู ุจูุฐุง ุงูุจุฑูุฏ ุงูุฅููุชุฑููู";
                        } else if (error.code === 'auth/wrong-password') {
                            errorMessage = "โ ูููุฉ ุงููุฑูุฑ ุบูุฑ ุตุญูุญุฉ";
                        } else if (error.code === 'auth/network-request-failed') {
                            errorMessage = "โ ูุดููุฉ ูู ุงูุงุชุตุงู ุจุงูุฅูุชุฑูุช";
                        } else {
                            errorMessage = "โ " + error.message;
                        }
                        
                        showMessage(loginMessage, errorMessage, "error");
                    })
                    .finally(() => {
                        // ุฅุนุงุฏุฉ ุชูููู ุงูุฒุฑ
                        loginBtn.disabled = false;
                        loginBtn.textContent = "ุชุณุฌูู ุงูุฏุฎูู";
                    });
            });
            
            // ุจุฏุก ุงูุชุญูู ูู ุญุงูุฉ ุงููุตุงุฏูุฉ ุจุนุฏ ุชุฃุฎูุฑ ุจุณูุท
            setTimeout(checkAuthState, 1000);
            
            // ุฏุงูุฉ ูุนุฑุถ ุงูุฑุณุงุฆู
            function showMessage(element, message, type) {
                element.innerHTML = `<div class="${type}">${message}</div>`;
                setTimeout(() => {
                    element.innerHTML = '';
                }, 5000);
            }
            
            // ุฏุงูุฉ ูุชุญููู ุงููุจุงุฑูุงุช (ุณูุชู ุชูููุฐูุง ูุงุญูุงู)
            function loadMatches() {
                console.log("๐ฅ ุฌุงุฑู ุชุญููู ุงููุจุงุฑูุงุช...");
                // ุณูุชู ุชูููุฐ ูุฐุง ูุงุญูุงู
            }
        });
    </script>

    <script src="simple-auth.js"></script>
</body>
</html>
